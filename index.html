<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Wi-Fi & Shop Info Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body { font-family: "Helvetica Neue", Arial, sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.8rem; }
        h2 { font-size: 1.1rem; border-left: 5px solid #667eea; padding-left: 10px; margin-top: 30px; color: #444; background: #f9f9f9; padding: 10px; border-radius: 0 5px 5px 0; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
        input[type="text"], input[type="url"], input[type="time"], select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 15px; box-sizing: border-box; }
        
        /* æ™‚é–“å…¥åŠ›ã®æ¨ªä¸¦ã³ */
        .time-row { display: flex; gap: 10px; }
        .time-col { flex: 1; }
        
        /* ãƒœã‚¿ãƒ³ */
        .btn-generate { width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px; font-size: 18px; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 30px; transition: 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        .btn-generate:hover { opacity: 0.95; transform: translateY(-1px); }
        .btn-generate:disabled { background: #ccc; cursor: not-allowed; }

        .btn-ai { background: #e8f0fe; color: #1a73e8; border: 1px solid #1a73e8; padding: 8px 15px; border-radius: 20px; font-weight: bold; cursor: pointer; font-size: 0.9rem; margin-top: 5px; width: 100%; transition: 0.2s; }
        .btn-ai:hover { background: #d2e3fc; }

        /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px; }
        @media (max-width: 800px) { .grid { grid-template-columns: 1fr; } }

        .panel { padding: 0 10px; }
        
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ */
        .preview-area { display: flex; flex-direction: column; gap: 20px; align-items: center; background: #fafafa; padding: 20px; border-radius: 10px; }
        .pop-card { background: white; border: 1px solid #ddd; padding: 20px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); width: 260px; position: relative; }
        .pop-card.premium { border: 2px solid #d4af37; background: #fffdf5; }
        .premium-badge { position: absolute; top: 0; right: 0; background: #d4af37; color: white; font-size: 10px; padding: 3px 8px; font-weight: bold; }
        
        .card-title { font-weight: bold; font-size: 1.2rem; margin-bottom: 5px; }
        .card-desc { font-size: 0.85rem; color: #666; margin-bottom: 10px; word-break: break-all; }
        .qr-box { margin: 15px auto; display: flex; justify-content: center; }
        .card-footer { font-size: 0.7rem; color: #999; margin-top: 10px; border-top: 1px dashed #ccc; padding-top: 5px; }
        
        .password-display { font-family: monospace; font-size: 1.1rem; background: #333; color: #0f0; padding: 8px; text-align: center; border-radius: 4px; word-break: break-all; margin: 10px 0; }
        
        /* AIæ¡ä»¶ã‚¨ãƒªã‚¢ */
        .ai-conditions { background: #f1f3f4; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px dashed #ccc; }
    </style>
</head>
<body>

<div class="container">
    <h1>Quantum Wi-Fi & Shop Info <span style="font-size:0.6em; color:#888;">Ver 0.4</span></h1>

    <div class="grid">
        <div class="panel">
            <h2>1. åŸºæœ¬æƒ…å ±</h2>
            <div class="input-group">
                <label>åº—èˆ—å / è¨­ç½®å ´æ‰€</label>
                <input type="text" id="shopName" placeholder="ä¾‹ï¼šCafe Gemini" oninput="updatePreview()">
            </div>
            
            <div class="input-group">
                <label>ä½æ‰€ï¼ˆè‡ªå‹•ã§åœ°å›³ãƒªãƒ³ã‚¯ã‚’ä½œæˆã—ã¾ã™ï¼‰</label>
                <input type="text" id="address" placeholder="ä¾‹ï¼šå¾³å³¶çœŒç¾é¦¬éƒ¡ã¤ã‚‹ãç”º..." oninput="updatePreview()">
            </div>

            <div class="input-group">
                <label>å–¶æ¥­æ™‚é–“</label>
                <div class="time-row">
                    <div class="time-col">
                        <span style="font-size:0.8rem">é–‹å§‹</span>
                        <input type="time" id="openTime">
                    </div>
                    <div class="time-col">
                        <span style="font-size:0.8rem">çµ‚äº†</span>
                        <input type="time" id="closeTime">
                    </div>
                </div>
            </div>
            <div class="input-group">
                <label>ãƒ©ã‚¹ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼ (ä»»æ„)</label>
                <input type="time" id="loTime">
            </div>

            <h2>2. Wi-Fi SSID è¨­å®š</h2>
            
            <div class="ai-conditions">
                <label style="color:#1a73e8;">ğŸ¤– AI å‘½åã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ (æœ‰æ–™ç‰ˆæ©Ÿèƒ½)</label>
                <div class="time-row" style="margin-top:10px;">
                    <div class="time-col">
                        <select id="category">
                            <option value="cafe">â˜• ã‚«ãƒ•ã‚§</option>
                            <option value="office">ğŸ¢ ã‚ªãƒ•ã‚£ã‚¹</option>
                            <option value="guest">ğŸ  ã‚²ã‚¹ãƒˆãƒã‚¦ã‚¹</option>
                            <option value="event">ğŸ‰ ã‚¤ãƒ™ãƒ³ãƒˆ</option>
                        </select>
                    </div>
                    <div class="time-col">
                        <select id="style">
                            <option value="simple">ã‚·ãƒ³ãƒ—ãƒ«</option>
                            <option value="stylish">ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥</option>
                            <option value="friendly">ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼</option>
                            <option value="security">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦–</option>
                        </select>
                    </div>
                </div>
                <button class="btn-ai" onclick="autoGenerateSSID()">âœ¨ AIã§SSIDã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹</button>
            </div>

            <div class="input-group">
                <label>SSIDï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åï¼‰</label>
                <input type="text" id="ssid" placeholder="ç”Ÿæˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã‹å…¥åŠ›ã—ã¦ãã ã•ã„">
            </div>
        </div>

        <div class="panel preview-area">
            <div class="pop-card">
                <div class="card-title">Free Wi-Fi</div>
                <div class="card-desc" id="wifiSsidPreview">SSID: ---</div>
                <div id="qrcode-wifi" class="qr-box"></div>
                <div style="font-size:0.8rem;">Pass: <span id="wifiPassPreview" style="font-weight:bold;">---</span></div>
            </div>

            <div class="pop-card premium">
                <div class="premium-badge">PRO Info Card</div>
                <div class="card-title" id="shopNamePreview">SHOP NAME</div>
                <div class="card-desc" style="font-size:0.8rem;">ãŠåº—ã®æƒ…å ±ã‚’ã‚¹ãƒãƒ›ã§è¡¨ç¤º<br>ï¼† åœ°å›³ã§é“æ¡ˆå†…</div>
                <div id="qrcode-info" class="qr-box"></div>
                <div class="card-footer">Map & Info automatically generated</div>
            </div>
        </div>
    </div>

    <button class="btn-generate" onclick="generateAll()">
        é‡å­ä¹±æ•°ã§ã‚­ãƒ¼ç”Ÿæˆ & ã‚«ãƒ¼ãƒ‰ä½œæˆ
    </button>
    
    <div id="result-area" style="margin-top:20px; display:none; text-align:center;">
        <p><strong>ç”Ÿæˆã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (WPA2/3):</strong></p>
        <div id="generatedPass" class="password-display">---</div>
        <button onclick="copyPass()" style="padding:8px 20px; cursor:pointer; background:#333; color:white; border:none; border-radius:5px;">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
</div>

<script>
    function updatePreview() {
        const name = document.getElementById('shopName').value || "SHOP NAME";
        document.getElementById('shopNamePreview').textContent = name;
    }

    // AIã«ã‚ˆã‚‹SSIDè‡ªå‹•ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
    function autoGenerateSSID() {
        const name = document.getElementById('shopName').value.trim() || "Spot";
        // è‹±æ•°å­—ä»¥å¤–ã‚’é™¤å»
        const cleanName = name.replace(/\s+/g, '').replace(/[^a-zA-Z0-9]/g, ''); 
        const category = document.getElementById('category').value;
        const style = document.getElementById('style').value;
        
        let newSSID = "";

        // æ¡ä»¶åˆ†å²ï¼šã‚«ãƒ†ã‚´ãƒª Ã— ã‚¹ã‚¿ã‚¤ãƒ«
        if (style === 'simple') {
            newSSID = `${cleanName}_WiFi`;
        } else if (style === 'stylish') {
            newSSID = `${cleanName}.Connect`;
        } else if (style === 'friendly') {
            newSSID = `Welcome_to_${cleanName}`;
        } else if (style === 'security') {
            const random = Math.floor(Math.random() * 999);
            newSSID = `${cleanName}_Secured_${random}`;
        }

        // ã‚«ãƒ†ã‚´ãƒªã«ã‚ˆã‚‹æ¥å°¾è¾ã®èª¿æ•´
        if (category === 'guest' && style !== 'friendly') newSSID += "_Guest";
        if (category === 'office' && style === 'simple') newSSID = `${cleanName}_Office`;
        if (category === 'event') newSSID = `${cleanName}_Event_Free`;

        document.getElementById('ssid').value = newSSID;
        
        // æ¼”å‡ºï¼šå…¥åŠ›æ¬„ã‚’å…‰ã‚‰ã›ã‚‹
        const ssidBox = document.getElementById('ssid');
        ssidBox.style.backgroundColor = "#e8f0fe";
        setTimeout(() => { ssidBox.style.backgroundColor = "white"; }, 500);
    }

    async function generateAll() {
        const btn = document.querySelector('.btn-generate');
        const ssid = document.getElementById('ssid').value || "My-WiFi";
        btn.disabled = true;
        btn.textContent = "é‡å­ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...";

        try {
            // ANUã‹ã‚‰é‡å­ä¹±æ•°ã‚’å–å¾—
            const response = await fetch('https://qrng.anu.edu.au/API/jsonI.php?length=16&type=uint8');
            const data = await response.json();
            const password = generatePasswordFromQuantum(data.data);

            // Wi-Fi QRç”Ÿæˆ
            const wifiString = `WIFI:S:${ssid};T:WPA;P:${password};;`;
            document.getElementById("qrcode-wifi").innerHTML = "";
            new QRCode(document.getElementById("qrcode-wifi"), {
                text: wifiString, width: 100, height: 100
            });
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
            document.getElementById('wifiSsidPreview').textContent = "SSID: " + ssid;
            document.getElementById('wifiPassPreview').textContent = password;
            document.getElementById('generatedPass').textContent = password;
            document.getElementById('result-area').style.display = 'block';

            // åº—èˆ—æƒ…å ±QRç”Ÿæˆ
            generateShopInfoQR();

            btn.textContent = "å†ç”Ÿæˆã™ã‚‹";
            btn.disabled = false;
            document.getElementById('result-area').scrollIntoView({behavior: "smooth"});

        } catch (e) {
            console.error(e);
            alert("é€šä¿¡ã‚¨ãƒ©ãƒ¼ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
            btn.disabled = false;
        }
    }

    function generateShopInfoQR() {
        const name = document.getElementById('shopName').value || "åº—èˆ—æƒ…å ±";
        const address = document.getElementById('address').value || "";
        
        // æ™‚é–“ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆä½œæˆ
        const open = document.getElementById('openTime').value;
        const close = document.getElementById('closeTime').value;
        const lo = document.getElementById('loTime').value;
        
        let hoursText = "";
        if(open && close) {
            hoursText = `${open} - ${close}`;
            if(lo) hoursText += ` (L.O. ${lo})`;
        } else {
            hoursText = "å–¶æ¥­æ™‚é–“: æœªè¨­å®š";
        }

        // Googleãƒãƒƒãƒ—URLã®è‡ªå‹•ç”Ÿæˆ (ä½æ‰€ã‹ã‚‰æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ä½œæˆ)
        let mapBtnHtml = "";
        if (address) {
            const mapQuery = encodeURIComponent(address);
            const mapUrl = `https://www.google.com/maps/search/?api=1&query=${mapQuery}`;
            mapBtnHtml = `<a href="${mapUrl}" class="btn" target="_blank">ğŸ“ Googleãƒãƒƒãƒ—ã§é“æ¡ˆå†…</a>`;
        }

        // è¡¨ç¤ºç”¨HTML (ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹)
        const htmlContent = `
            <html>
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${name}</title>
                <style>
                    body { font-family: sans-serif; padding: 20px; text-align: center; background: #fafafa; color:#333; line-height: 1.6; }
                    .card { background: white; padding: 30px 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 400px; margin: 0 auto; }
                    h1 { margin: 0 0 15px; color: #333; font-size: 1.5rem; }
                    .info-row { margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
                    .label { font-size: 0.8rem; color: #888; display: block; margin-bottom: 2px; }
                    .val { font-size: 1rem; font-weight: bold; }
                    .btn { display: inline-block; background: #4285f4; color: white; padding: 12px 25px; text-decoration: none; border-radius: 50px; margin-top: 20px; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
                </style>
            </head>
            <body>
                <div class="card">
                    <h1>${name}</h1>
                    
                    <div class="info-row">
                        <span class="label">ADDRESS</span>
                        <div class="val">${address || "ä½æ‰€æœªå…¥åŠ›"}</div>
                    </div>
                    
                    <div class="info-row" style="border:none;">
                        <span class="label">OPEN HOURS</span>
                        <div class="val">${hoursText}</div>
                    </div>

                    ${mapBtnHtml}
                </div>
            </body>
            </html>
        `;

        const dataUrl = "data:text/html;charset=utf-8," + encodeURIComponent(htmlContent);

        document.getElementById("qrcode-info").innerHTML = "";
        new QRCode(document.getElementById("qrcode-info"), {
            text: dataUrl, width: 100, height: 100,
            colorDark : "#d4af37", // æœ‰æ–™ç‰ˆã£ã½ãã‚´ãƒ¼ãƒ«ãƒ‰ç³»ã®è‰²
            colorLight : "#ffffff"
        });
    }

    function generatePasswordFromQuantum(numbers) {
        const chars = "abcdefghijkmnpqrstuvwxyz23456789ABCDEFGHJKLMNPQRSTUVWXYZ"; 
        let pass = "";
        for (let i = 0; i < numbers.length; i++) {
            pass += chars[numbers[i] % chars.length];
        }
        return pass.substring(0, 12);
    }
    
    function copyPass() {
        navigator.clipboard.writeText(document.getElementById('generatedPass').textContent);
        alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
    }
</script>

</body>
</html>
