<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Wi-Fi & Shop Info Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body { font-family: "Helvetica Neue", Arial, sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.8rem; }
        h2 { font-size: 1.2rem; border-left: 5px solid #667eea; padding-left: 10px; margin-top: 0; color: #444; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9rem; }
        input[type="text"], input[type="url"], select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 15px; box-sizing: border-box; }
        
        /* ãƒœã‚¿ãƒ³ */
        .btn-generate { width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px; font-size: 18px; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 20px; transition: 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.2); }
        .btn-generate:hover { opacity: 0.95; transform: translateY(-1px); }
        .btn-generate:disabled { background: #ccc; cursor: not-allowed; }

        /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px; }
        @media (max-width: 800px) { .grid { grid-template-columns: 1fr; } }

        .panel { background: #f9f9f9; padding: 20px; border-radius: 8px; border: 1px solid #eee; height: 100%; box-sizing: border-box; }
        
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚«ãƒ¼ãƒ‰ */
        .preview-area { display: flex; flex-direction: column; gap: 20px; align-items: center; }
        .pop-card { background: white; border: 1px solid #ddd; padding: 20px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); width: 240px; position: relative; }
        .pop-card.premium { border: 2px solid #d4af37; background: #fffdf5; }
        .premium-badge { position: absolute; top: 0; right: 0; background: #d4af37; color: white; font-size: 10px; padding: 3px 8px; font-weight: bold; }
        
        .card-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
        .card-desc { font-size: 0.8rem; color: #666; margin-bottom: 10px; }
        .qr-box { margin: 10px auto; display: flex; justify-content: center; }
        .card-footer { font-size: 0.7rem; color: #999; margin-top: 10px; border-top: 1px dashed #ccc; padding-top: 5px; }
        
        .password-display { font-family: monospace; font-size: 1.1rem; background: #333; color: #0f0; padding: 8px; text-align: center; border-radius: 4px; word-break: break-all; margin: 10px 0; }
    </style>
</head>
<body>

<div class="container">
    <h1>Quantum Wi-Fi & Shop Info <span style="font-size:0.6em; color:#888;">Ver 0.3</span></h1>

    <div class="grid">
        <div class="panel">
            <h2>1. Wi-Fi è¨­å®š</h2>
            <div class="input-group">
                <label>SSIDï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åï¼‰</label>
                <input type="text" id="ssid" placeholder="My-Shop-WiFi">
            </div>
            
            <h2 style="margin-top:30px;">2. åº—èˆ—æƒ…å ± (æœ‰æ–™ç‰ˆæ©Ÿèƒ½)</h2>
            <div class="input-group">
                <label>åº—èˆ—å</label>
                <input type="text" id="shopName" placeholder="ä¾‹ï¼šCafe Gemini" oninput="updatePreview()">
            </div>
            <div class="input-group">
                <label>ä½æ‰€ / ã‚¢ã‚¯ã‚»ã‚¹</label>
                <input type="text" id="address" placeholder="ä¾‹ï¼šå¾³å³¶çœŒã€‡ã€‡å¸‚... å¾’æ­©5åˆ†">
            </div>
            <div class="input-group">
                <label>Googleãƒãƒƒãƒ— URL (ä»»æ„)</label>
                <input type="url" id="mapUrl" placeholder="https://goo.gl/maps/...">
            </div>
            <div class="input-group">
                <label>å–¶æ¥­æ™‚é–“ / ãŠçŸ¥ã‚‰ã›</label>
                <input type="text" id="hours" placeholder="ä¾‹ï¼š9:00 - 20:00 (å®šä¼‘æ—¥: æœˆ)">
            </div>
        </div>

        <div class="panel preview-area">
            <div class="pop-card">
                <div class="card-title">Wi-Fi ä½¿ãˆã¾ã™</div>
                <div class="card-desc" id="wifiSsidPreview">SSID: ---</div>
                <div id="qrcode-wifi" class="qr-box"></div>
                <div style="font-size:0.8rem;">Pass: <span id="wifiPassPreview" style="font-weight:bold;">---</span></div>
            </div>

            <div class="pop-card premium">
                <div class="premium-badge">Info Card</div>
                <div class="card-title" id="shopNamePreview">SHOP NAME</div>
                <div class="card-desc">ãŠåº—ã®æƒ…å ±ã‚’ã‚¹ãƒãƒ›ã§è¡¨ç¤º</div>
                <div id="qrcode-info" class="qr-box"></div>
                <div class="card-footer">Scan for Map & Info</div>
            </div>
        </div>
    </div>

    <button class="btn-generate" onclick="generateAll()">
        é‡å­ä¹±æ•°ã§ã‚­ãƒ¼ç”Ÿæˆ & ã‚«ãƒ¼ãƒ‰ä½œæˆ
    </button>
    
    <div id="result-area" style="margin-top:20px; display:none; text-align:center;">
        <p><strong>ç”Ÿæˆã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:</strong></p>
        <div id="generatedPass" class="password-display">---</div>
        <button onclick="copyPass()" style="padding:5px 15px; cursor:pointer;">ã‚³ãƒ”ãƒ¼</button>
        <p style="font-size:0.8rem; color:#666;">â€»ã“ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ«ãƒ¼ã‚¿ãƒ¼ã«è¨­å®šã—ã¦ãã ã•ã„</p>
    </div>
</div>

<script>
    function updatePreview() {
        const name = document.getElementById('shopName').value || "SHOP NAME";
        document.getElementById('shopNamePreview').textContent = name;
    }

    async function generateAll() {
        const btn = document.querySelector('.btn-generate');
        const ssid = document.getElementById('ssid').value || "My-WiFi";
        btn.disabled = true;
        btn.textContent = "é‡å­ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...";

        try {
            // 1. ANUã‹ã‚‰é‡å­ä¹±æ•°ã‚’å–å¾—ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ
            const response = await fetch('https://qrng.anu.edu.au/API/jsonI.php?length=16&type=uint8');
            const data = await response.json();
            const password = generatePasswordFromQuantum(data.data);

            // 2. Wi-Fi QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
            const wifiString = `WIFI:S:${ssid};T:WPA;P:${password};;`;
            document.getElementById("qrcode-wifi").innerHTML = "";
            new QRCode(document.getElementById("qrcode-wifi"), {
                text: wifiString, width: 100, height: 100
            });
            
            // ç”»é¢æ›´æ–°
            document.getElementById('wifiSsidPreview').textContent = "SSID: " + ssid;
            document.getElementById('wifiPassPreview').textContent = password;
            document.getElementById('generatedPass').textContent = password;
            document.getElementById('result-area').style.display = 'block';

            // 3. åº—èˆ—æƒ…å ±ãƒšãƒ¼ã‚¸(Data URL)ã®ç”Ÿæˆ
            generateShopInfoQR();

            btn.textContent = "å†ç”Ÿæˆã™ã‚‹";
            btn.disabled = false;

        } catch (e) {
            console.error(e);
            alert("é€šä¿¡ã‚¨ãƒ©ãƒ¼ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
            btn.disabled = false;
        }
    }

    function generateShopInfoQR() {
        // å…¥åŠ›å€¤ã‚’å–å¾—
        const name = document.getElementById('shopName').value || "åº—èˆ—æƒ…å ±";
        const address = document.getElementById('address').value || "";
        const hours = document.getElementById('hours').value || "";
        const mapUrl = document.getElementById('mapUrl').value || "";

        // ç°¡æ˜“HTMLãƒšãƒ¼ã‚¸ã‚’ä½œæˆ
        const htmlContent = `
            <html>
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${name}</title>
                <style>
                    body { font-family: sans-serif; padding: 20px; text-align: center; background: #fafafa; color:#333; }
                    .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                    h1 { margin: 0 0 10px; color: #444; }
                    .btn { display: inline-block; background: #4285f4; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin-top: 15px; }
                </style>
            </head>
            <body>
                <div class="card">
                    <h1>${name}</h1>
                    <p>ğŸ“ ${address}</p>
                    <p>ğŸ•’ ${hours}</p>
                    ${mapUrl ? `<a href="${mapUrl}" class="btn" target="_blank">Googleãƒãƒƒãƒ—ã§è¦‹ã‚‹</a>` : ''}
                </div>
            </body>
            </html>
        `;

        // HTMLã‚’Data URLåŒ– (ã‚µãƒ¼ãƒãƒ¼ä¸è¦ã§Webãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹æŠ€è¡“)
        const dataUrl = "data:text/html;charset=utf-8," + encodeURIComponent(htmlContent);

        // åº—èˆ—æƒ…å ±QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
        document.getElementById("qrcode-info").innerHTML = "";
        // QRã‚³ãƒ¼ãƒ‰ã®åˆ¶é™ã‚’è¶…ãˆãªã„ã‚ˆã†ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒã‚ã‚‹ã¨è‰¯ã„ãŒã€ä»Šå›ã¯ç°¡æ˜“å®Ÿè£…
        new QRCode(document.getElementById("qrcode-info"), {
            text: dataUrl, width: 100, height: 100
        });
    }

    function generatePasswordFromQuantum(numbers) {
        const chars = "abcdefghijkmnpqrstuvwxyz23456789ABCDEFGHJKLMNPQRSTUVWXYZ"; 
        let pass = "";
        for (let i = 0; i < numbers.length; i++) {
            pass += chars[numbers[i] % chars.length];
        }
        return pass.substring(0, 12);
    }
    
    function copyPass() {
        navigator.clipboard.writeText(document.getElementById('generatedPass').textContent);
        alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ");
    }
</script>

</body>
</html>
